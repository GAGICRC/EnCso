<?phpinclude_once TEMPLATE_PATH.'/site/helper/format.php';$project = $SOUP->get('project');// only organizers or creator may edit$hasPermission = ( Session::isAdmin() ||					ProjectUser::isOrganizer(Session::getUserID(), $project->getID()) ||					ProjectUser::isCreator(Session::getUserID(), $project->getID()) );$formattedRules = formatRules($project->getRules());										$fork = $SOUP->fork();$fork->set('title', "Rules");$fork->set('id', "rules");$fork->set('editable', $hasPermission);//$fork->set('editLabel', 'Edit Rules');$fork->startBlockSet('body');?><?php if($hasPermission): ?><script type="text/javascript">$(document).ready(function(){	$("#btnSaveRules").mousedown(function(){		buildPost({			'processPage':'<?= Url::detailsProcess($project->getID()) ?>',			'info':			{				'action':'rules',				'rules':$("#txtRules").val()			},			'buttonID':'#btnSaveRules'		});	});	$("#btnCancelRules").mousedown(function(){		$("#rules .edit").hide();		$("#rules .view").fadeIn();	});	$("#rules .editButton").click(function(){		var edit = $("#rules .edit");		var view = $("#rules .view");		toggleEditView(edit, view);		if($(view).is(":hidden"))			$('#txtRules').focus();	});});</script><div class="edit hidden"><div class="clear">	<label for="txtRules">Rules<span class="required">*</span></label>	<div class="input">		<textarea id="txtRules"><?= html_entity_decode($project->getRules()) ?></textarea>		<p>One rule per line</p>	</div></div><div class="clear">	<div class="input">		<input id="btnSaveRules" type="button" value="Save" />		<input id="btnCancelRules" type="button" value="Cancel" />	</div></div></div><?php endif; ?><div class="view"><?phpif($formattedRules != null) {	echo '<ul class="segmented-list rules">';	foreach($formattedRules as $rule)		echo '<li>'.$rule.'</li>';	echo '</ul>';} else {	echo "<p>(none)</p>";}?></div><?php$fork->endBlockSet();$fork->render('site/partial/panel');