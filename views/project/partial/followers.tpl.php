<?phpinclude_once TEMPLATE_PATH.'/site/helper/format.php';$project = $SOUP->get('project');$followers = $SOUP->get('followers');$fork = $SOUP->fork();$fork->set('id', 'followers');$fork->set('title', 'Followers');$fork->set('creatable', true);$fork->set('createLabel', 'Invite');$fork->set('editable', true);$fork->startBlockSet('body');?><script type="text/javascript">$(document).ready(function(){	$("#followers .editButton").click(function(){		var buttons = $("#followers div.view input[type='button']");		if($(buttons).is(":hidden")) {			$(buttons).fadeIn();		} else {			$(buttons).fadeOut();		}	});		$("#followers .createButton").click(function(){		var invite = $("#followers .invite");		var view = $("#followers .view");		toggleEditView(view, invite);		if($(view).is(":hidden"))			$('#txtInviteFollowers').focus();	});		$("#btnCancelFollowers").click(function(){		$("#followers .invite").hide();		$("#followers .view").fadeIn();	});		$("#followers input.ban").click(function(){		var id = $(this).attr('id').substring(4);		buildPost({			'processPage': '<?= Url::peopleProcess($project->getID()) ?>',			'info': {				'action': 'ban',				'userID': id			},			'buttonID': $(this)		});	});		$("#followers input.organizer").click(function(){		var id = $(this).attr('id').substring(10);		buildPost({			'processPage': '<?= Url::peopleProcess($project->getID()) ?>',			'info': {				'action': 'make-organizer',				'userID': id			},			'buttonID': $(this)		});	});	$( "#txtInviteFollowers" )	// don't navigate away from the field on tab when selecting an item	.bind( "keydown", function( event ) {		if ( event.keyCode === $.ui.keyCode.TAB &&				$( this ).data( "autocomplete" ).menu.active ) {			event.preventDefault();		}	})	.autocomplete({		source: function( request, response ) {			$.getJSON( '<?= Url::peopleSearch($project->getID()) ?>/not-affiliated', {				term: extractLast( request.term )			}, response );		},		search: function() {			// custom minLength			var term = extractLast( this.value );			if ( term.length < 2 ) {				return false;			}		},		focus: function() {			// prevent value inserted on focus			return false;		},		select: function( event, ui ) {			var terms = split( this.value );			// remove the current input			terms.pop();			// add the selected item			terms.push( ui.item.value );			// add placeholder to get the comma-and-space at the end			terms.push( "" );			this.value = terms.join( ", " );			return false;		}	});			$('#btnInviteFollowers').click(function() {		buildPost({			'processPage': '<?= Url::peopleProcess($project->getID()) ?>',			'info': {				'action': 'invite-followers',				'invitees': $('#txtInviteFollowers').val(),				'message': $('#txtInviteMessage').val()			},			'buttonID': '#btnInviteFollowers'		});	});});</script><div class="view"><?php if($followers != null) {	echo '<ul class="segmented-list users">';	foreach($followers as $f) {		echo '<li>';		echo '<input id="ban-'.$f->getID().'" type="button" class="ban hidden" value="Ban" />';		echo '<input id="organizer-'.$f->getID().'" type="button" class="organizer hidden" value="Make Organizer" />';		echo formatUserPicture($f->getID(), 'small');		echo '<h6 class="primary">'.formatUserLink($f->getID()).'</h6>';		echo '<p class="secondary">follower</p>';		echo '</li>';	}	echo '</ul>';} else {	echo '<p>(none)</p>';}?></div><div class="invite hidden">	<div class="clear">		<label for="txtInviteFollowers">People to Invite<span class="required">*</span></label>		<div class="input">			<input type="text" id="txtInviteFollowers" />			<p>Usernames or email addresses, separated by commas</p>		</div>	</div>	<div class="clear">		<label for="txtInviteMessage">Message</label>		<div class="input">			<textarea id="txtInviteMessage"></textarea>			<p>Why the recipient(s) should follow this project</p>		</div>	</div>		<div class="clear">		<div class="input">			<input type="button" id="btnInviteFollowers" value="Invite" />			<input type="button" id="btnCancelFollowers" value="Cancel" />		</div>	</div></div><?php$fork->endBlockSet();$fork->render('site/partial/panel');