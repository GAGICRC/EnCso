<?phpinclude_once TEMPLATE_PATH.'/site/helper/format.php';$accepted = $SOUP->get('accepted');$update = $SOUP->get('update');$updates = $SOUP->get('updates');$uploads = $SOUP->get('uploads');$task = $SOUP->get('task', null);// only update creator may edit or create$hasPermission = ( Session::isAdmin() ||				($update->getCreatorID() == Session::getUserID()) );$fork = $SOUP->fork();$fork->set('title', 'Contribution');$fork->set('id', 'update');$fork->set('editable', $hasPermission);$fork->set('editLabel', 'Edit');$fork->startBlockSet('body');?><?php if($hasPermission): ?><script type="text/javascript">$(document).ready(function(){		$('#selStatus').val('<?= $accepted->getStatus() ?>');		$('#btnEditUpdate').click(function(){		buildPost({			'processPage':'<?= Url::updateProcess($update->getID()) ?>',			'info': $('#frmEditItem').serialize(),			'buttonID':'#btnEditUpdate'		});	});		$("#update .editButton").click(function(){		$(this).hide();		$("#update .view").hide();		$("#update .edit").fadeIn();		$('#txtTitle').focus();				});		$("#btnCancelUpdate").click(function(){		$("#update .edit").hide();		$("#update .view").fadeIn();		$("#update .editButton").fadeIn();	});		});</script><div class="edit hidden"><form id="frmEditItem"><input type="hidden" name="action" value="edit-update" /><div class="clear">	<label for="txtTitle">Title<span class="required">*</span></label>	<div class="input">		<input type="text" id="txtTitle" name="txtTitle" maxlength="255" value="<?= $update->getTitle() ?>" />		<p>Short title for the contribution</p>	</div></div><div class="clear">	<label for="txtMessage">Message<span class="required">*</span></label>	<div class="input">		<textarea id="txtMessage" name="txtMessage"><?= $update->getMessage() ?></textarea>		<p>Write your contribution here</p>	</div></div><?php if($update->isLatestUpdate()): ?><div class="clear">	<label for="selStatus">Status<span class="required">*</span></label>	<div class="input">		<select id="selStatus" name="selStatus">			<option value="<?= Accepted::STATUS_PROGRESS ?>"><?= Accepted::getStatusName(Accepted::STATUS_PROGRESS) ?></option>			<option value="<?= Accepted::STATUS_FEEDBACK ?>"><?= Accepted::getStatusName(Accepted::STATUS_FEEDBACK) ?></option>			<option value="<?= Accepted::STATUS_COMPLETED ?>"><?= Accepted::getStatusName(Accepted::STATUS_COMPLETED) ?></option>			<option value="<?= Accepted::STATUS_RELEASED ?>"><?= Accepted::getStatusName(Accepted::STATUS_RELEASED) ?></option>		</select>	</div></div><?php endif; ?><div class="clear">	<div class="input">		<input id="btnEditUpdate" type="button" value="Save" />		<input id="btnCancelUpdate" type="button" value="Cancel" />	</div></div></form></div><!-- end .edit --><?php endif; ?><div class="view"><div class="person-box">	<a class="picture large" href="<?= Url::user($update->getCreatorID()) ?>"><img src="<?= Url::userPictureLarge($update->getCreatorID()) ?>" /></a>	<div class="text">		<p class="caption">posted by</p>		<p class="username"><?= formatUserLink($update->getCreatorID()) ?></p>	</div></div><?phpif($update->isLatestUpdate()) {	$status = '<span class="status">'.Accepted::getStatusName($accepted->getStatus()).'</span>';	$status .= ' <span class="slash">/</span> ';} else {	$status = '';}?><h5><a href="<?= Url::update($update->getID()) ?>"><?= $update->getTitle() ?></a></h5><p><?= $status ?>posted <?= formatTimeTag($update->getDateCreated()) ?></p><div class="line"></div><p><?= formatUpdate($update->getMessage()) ?></p></div><!-- end .view --><?php$fork->endBlockSet();$fork->render('site/partial/panel');